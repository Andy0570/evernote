# 7. 网站的可扩展架构

网站的扩展性架构设计：在对现有系统影响最小的情况下，系统功能可持续扩展及提升的能力。

### 扩展性 & 伸缩性

**扩展性（Extensibility）**
指对现有系统影响最小的情况下，系统功能可持续扩展或提升的能力。表现在系统基础设施稳定不需要经常变更，应用之间较少依赖和耦合，对需求变更可以敏捷响应。它是系统架构设计层面的开闭原则（对扩展开放，对修改关闭），架构设计考虑未来功能扩展，当系统增加新功能时，不需要对现有系统的结构和代码进行修改。

**伸缩性（Scalability）**
指系统能够通过增加（减少）自身资源规模的方式增强（减少）自己计算处理事务的能力。如果这种增减是成比例的，就被称作线性伸缩性。在网站架构中，通常指利用集群的方式增加服务器数量、提高系统的整体事务吞吐能力。


## 7.1 构建可扩展的网站架构
低耦合的系统更容易扩展，低耦合的模块更容易复用，一个低耦合的系统设计也会让开发过程和维护变得更加轻松和容易管理。

* 设计网站的可扩展架构的核心思想是**模块化**，并在此基础上，降低模块之间的耦合性，提高模块的复用性。
* 分层和分割也是模块化设计的重要手段。
* 在大型网站中，各模块通过分布式部署的方式，独立的模块部署在独立的服务器（集群）上，从物理分离模块之间的耦合关系，进一步降低耦合性提高复用性。

模块分布式部署后的聚合方式：
1. 分布式消息队列。
2. 分布式服务。

## 7.2 利用分布式消息队列降低系统耦合性

### 事件驱动架构

> 通过在低耦合的模块之间传输事件消息，以保持模块的松散耦合，并借助事件消息的通信完成模块间合作。

实现手段：分布式消息队列。

### 分布式消息队列

队列：先进先出的数据结构。分布式消息队列将这种数据结构部署在独立的服务器上。

分布式消息队列产品：Apache ActiveMQ、Kafka。

## 7.3 利用分布式服务打造可复用的业务平台

**分布式消息队列**通过消息对象分解系统耦合性，不同子系统处理同一个消息。
**分布式服务**通过接口分解系统耦合性。

巨无霸应用的难题：
1. 编辑、部署困难；
2. 代码分支管理困难；
3. 数据库连接耗尽；
4. 新增业务困难；

解决方案：**拆分**，将模块独立部署，降低系统耦合性。
* **纵向拆分**：讲一个大应用拆分为多个小应用。
* **横向拆分**：将复用的业务拆分出来，独立部署为分布式服务。


### 大型网站分布式服务的需求与特点
* 负载均衡；
* 失效转移；
* 高效的远程通信；
* 整合异构系统；
* 对应用最少侵入；
* 版本管理；
* 实时监控

### 分布式服务框架设计
* Thrift（一个开源的远程服务调用框架）。
* 阿里巴巴的 Dubbo。（开源分布式服务框架）。

### 可扩展的数据结构

传统的关系型数据库不支持可扩展的数据结构设计。

解决方案：许多 NoSQL 数据库使用的 ColumnFamily（列族）设计。

### 利用开放平台建设网站生态圈

开放平台是网站内部和外部交互的接口，外部需要面对众多第三方开发者，内部需要面对网站内诸多的业务服务。

![image](http://upload-images.jianshu.io/upload_images/2648731-712f8e3685b39b6b.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
