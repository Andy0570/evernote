[TOC]

## if åˆ†æ”¯ç»“æ„

if è¯­å¥çš„è¯­æ³•ï¼š
```bash
if commands; then
     commands
[elif commands; then
     commands...]
[else
     commands]
fi
```

bash shell çš„ if è¯­å¥ä¼šè¿è¡Œ if åé¢çš„é‚£ä¸ªå‘½ä»¤ã€‚å¦‚æœè¯¥å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç æ˜¯ 0ï¼ˆè¯¥å‘½ä»¤æˆåŠŸè¿è¡Œï¼‰ï¼Œä½äº then éƒ¨åˆ†çš„å‘½ä»¤å°±ä¼šè¢«æ‰§è¡Œã€‚å¦‚æœè¯¥å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç æ˜¯å…¶ä»–å€¼ï¼Œthen éƒ¨åˆ†çš„å‘½ä»¤å°±ä¸ä¼šè¢«æ‰§è¡Œï¼Œbash shell ä¼šç»§ç»­æ‰§è¡Œè„šæœ¬ä¸­çš„ä¸‹ä¸€ä¸ªå‘½ä»¤ã€‚fi è¯­å¥ç”¨æ¥è¡¨ç¤º if-then è¯­å¥åˆ°æ­¤ç»“æŸã€‚

ç¤ºä¾‹ä»£ç ï¼š
```bash
x=5
if [ $x = 5 ]; then
    echo "x equals 5."
else
    echo "x does not equal 5."
fi
```

## é€€å‡ºçŠ¶æ€ï¼š`$?`

å½“å‘½ä»¤æ‰§è¡Œå®Œæ¯•åï¼Œå‘½ä»¤ï¼ˆåŒ…æ‹¬æˆ‘ä»¬ç¼–å†™çš„è„šæœ¬å’Œ shell å‡½æ•°ï¼‰ä¼šç»™ç³»ç»Ÿå‘é€ä¸€ä¸ªå€¼ï¼Œå«åš**é€€å‡ºçŠ¶æ€**ã€‚ è¿™ä¸ªå€¼æ˜¯ä¸€ä¸ª 0 åˆ° 255 ä¹‹é—´çš„æ•´æ•°ï¼Œè¯´æ˜å‘½ä»¤æ‰§è¡ŒæˆåŠŸæˆ–æ˜¯å¤±è´¥ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œä¸€ä¸ªé›¶å€¼è¯´æ˜æˆåŠŸï¼Œå…¶å®ƒæ‰€æœ‰å€¼è¯´æ˜å¤±è´¥ã€‚ Shell æä¾›äº†ä¸€ä¸ªå‚æ•°ï¼ˆ$?ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ£€æŸ¥é€€å‡ºçŠ¶æ€ã€‚

```bash
echo $?
```

* true å‘½ä»¤æ€»æ˜¯æ‰§è¡ŒæˆåŠŸï¼Œè€Œ false å‘½ä»¤æ€»æ˜¯æ‰§è¡Œå¤±è´¥


ç¤ºä¾‹ï¼š
```shell
$ date
Tue Mar 26 13:44:27 CST 2019

# æˆåŠŸç»“æŸçš„å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç æ˜¯ 0ã€‚
# æ— æ•ˆå‘½ä»¤ä¼šè¿”å›ä¸€ä¸ªé€€å‡ºçŠ¶æ€ç 127ã€‚
$ echo $?
0
```

| Linux çŠ¶æ€ç  | æè¿° |
| ----------- | ---- |
|0 |å‘½ä»¤æˆåŠŸç»“æŸ|
|1 |ä¸€èˆ¬æ€§æœªçŸ¥é”™è¯¯|
|2 |ä¸é€‚åˆçš„shellå‘½ä»¤|
|126 |å‘½ä»¤ä¸å¯æ‰§è¡Œ|
|127 |æ²¡æ‰¾åˆ°å‘½ä»¤|
|128 |æ— æ•ˆçš„é€€å‡ºå‚æ•°|
|128+x |ä¸Linuxä¿¡å·xç›¸å…³çš„ä¸¥é‡é”™è¯¯|
|130 |é€šè¿‡Ctrl+Cç»ˆæ­¢çš„å‘½ä»¤|
|255 |æ­£å¸¸èŒƒå›´ä¹‹å¤–çš„é€€å‡ºçŠ¶æ€ç |

ä½ å¯ä»¥æ”¹å˜è¿™ç§é»˜è®¤è¡Œä¸ºï¼Œè¿”å›è‡ªå·±çš„é€€å‡ºçŠ¶æ€ç ã€‚`exit` å‘½ä»¤å…è®¸ä½ åœ¨è„šæœ¬ç»“æŸæ—¶æŒ‡å®šä¸€ä¸ªé€€å‡ºçŠ¶æ€ç ã€‚
é€€å‡ºçŠ¶æ€ç è¢«ç¼©å‡åˆ°äº†0ï½255çš„åŒºé—´ã€‚

```shell
#!/bin/bash
# testing the exit status
var1=10
var2=30
var3=$[$var1 + $var2]
echo The answer is $var3
exit 5
```


## æµ‹è¯•å‘½ä»¤ï¼š`test`

> `test` å‘½ä»¤æä¾›äº†åœ¨ if-then è¯­å¥ä¸­æµ‹è¯•ä¸åŒæ¡ä»¶çš„é€”å¾„ã€‚å¦‚æœ `test` å‘½ä»¤ä¸­åˆ—å‡ºçš„æ¡ä»¶æˆç«‹ï¼Œ`test` å‘½ä»¤å°±ä¼šé€€å‡ºå¹¶è¿”å›é€€å‡ºçŠ¶æ€ç 0ã€‚è¿™æ · if-then è¯­å¥å°±ä¸å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­çš„ if-then è¯­å¥ä»¥ç±»ä¼¼çš„æ–¹å¼å·¥ä½œäº†ã€‚å¦‚æœæ¡ä»¶ä¸æˆç«‹ï¼Œ`test` å‘½ä»¤å°±ä¼šé€€å‡ºå¹¶è¿”å›éé›¶çš„é€€å‡ºçŠ¶æ€ç ï¼Œè¿™ä½¿å¾— if-then è¯­å¥ä¸ä¼šå†è¢«æ‰§è¡Œã€‚

`test` å‘½ä»¤æœ‰ä¸¤ç§ç­‰ä»·æ¨¡å¼ï¼š
```shell
test expression
```
æ¯”è¾ƒæµè¡Œçš„æ ¼å¼æ˜¯ï¼ˆæ³¨æ„ç©ºæ ¼ä¸å¯å°‘ï¼‰ï¼š
```shell
[ expression ]
```
è¿™é‡Œçš„ expression æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå…¶æ‰§è¡Œç»“æœæ˜¯ true æˆ–è€…æ˜¯ falseã€‚å½“è¡¨è¾¾å¼ä¸ºçœŸæ—¶ï¼Œ`test` å‘½ä»¤è¿”å›é€€å‡ºçŠ¶æ€ç 0ï¼Œå½“è¡¨è¾¾å¼ä¸ºå‡æ—¶ï¼Œ`test` å‘½ä»¤è¿”å›é€€å‡ºçŠ¶æ€ç 1ã€‚

`test` å‘½ä»¤å¯ä»¥åˆ¤æ–­ä¸‰ç±»æ¡ä»¶ï¼š
* æ•°å€¼æ¯”è¾ƒï¼›
* å­—ç¬¦ä¸²æ¯”è¾ƒï¼›
* æ–‡ä»¶æ¯”è¾ƒï¼›

### æ•°å€¼æ¯”è¾ƒ

> âš ï¸ ä¸èƒ½åœ¨ `test` å‘½ä»¤ä¸­ä½¿ç”¨æµ®ç‚¹å€¼ï¼

|æµ‹è¯•æ•´æ•°è¡¨è¾¾å¼	|å¦‚æœä¸ºçœŸ...|
|---------------|---------|
|integer1 -eq integer2	|integer1 ç­‰äº integer2.|
|integer1 -ne integer2	|integer1 ä¸ç­‰äº integer2.|
|integer1 -le integer2	|integer1 å°äºæˆ–ç­‰äº integer2.|
|integer1 -lt integer2	|integer1 å°äº integer2.|
|integer1 -ge integer2	|integer1 å¤§äºæˆ–ç­‰äº integer2.|
|integer1 -gt integer2	|integer1 å¤§äº integer2.|

ç¤ºä¾‹ä»£ç ï¼š
```bash
#!/bin/bash
# test-integer: evaluate the value of an integer.
INT=-5
if [ -z "$INT" ]; then
    echo "INT is empty." >&2
    exit 1
fi
if [ $INT -eq 0 ]; then
    echo "INT is zero."
else
    if [ $INT -lt 0 ]; then
        echo "INT is negative."
    else
        echo "INT is positive."
    fi
    if [ $((INT % 2)) -eq 0 ]; then
        echo "INT is even."
    else
        echo "INT is odd."
    fi
fi
```

### å­—ç¬¦ä¸²æ¯”è¾ƒ

|æµ‹è¯•å­—ç¬¦ä¸²è¡¨è¾¾å¼	|å¦‚æœä¸ºçœŸ...|
|---------------|---------|
|string	|string ä¸ä¸º nullã€‚|
|-n string	|å­—ç¬¦ä¸² string çš„é•¿åº¦å¤§äºé›¶ã€‚|
|-z string	|å­—ç¬¦ä¸² string çš„é•¿åº¦ä¸ºé›¶ã€‚|
|string1 = string2|string1 å’Œ string2 ç›¸åŒã€‚å•æˆ–åŒç­‰å·éƒ½å¯ä»¥ï¼Œä¸è¿‡åŒç­‰å·æ›´å—æ¬¢è¿ã€‚|
|string1 == string2| åŒä¸Š|
|string1 != string2	|string1 å’Œ string2 ä¸ç›¸åŒã€‚|
|string1 > string2	|sting1 æ’åˆ—åœ¨ string2 ä¹‹åã€‚|
|string1 < string2	|string1 æ’åˆ—åœ¨ string2 ä¹‹å‰ã€‚|

> âš ï¸ å½“ä¸ `test` ä¸€å—ä½¿ç”¨çš„æ—¶å€™ï¼Œ < å’Œ > è¡¨è¾¾å¼æ“ä½œç¬¦å¿…é¡»ç”¨å¼•å·å¼•èµ·æ¥ï¼ˆæˆ–è€…æ˜¯ç”¨åæ–œæ è½¬ä¹‰ï¼‰ï¼Œå¦åˆ™ä¼šè¢«è¯¯è§£é‡Šä¸ºé‡å®šå‘ç¬¦ã€‚

```shell
#!/bin/bash
# æ­£ç¡®è½¬ä¹‰å¤§äºç¬¦å·
val1=baseball
val2=hocky
if [ $val1 \> $val2 ]; then
   echo "$val1 is greater than $val2"
else
   echo "$val1 is less than $val2"
fi
```

> åœ¨ `test` æ¯”è¾ƒæµ‹è¯•ä¸­ï¼Œå¤§å†™å­—æ¯è¢«è®¤ä¸ºæ˜¯å°äºå°å†™å­—æ¯çš„ã€‚ä½† `sort` å‘½ä»¤æ°å¥½ç›¸åã€‚å½“ä½ å°†åŒæ ·çš„å­—ç¬¦ä¸²æ”¾è¿›æ–‡ä»¶ä¸­å¹¶ç”¨ `sort` å‘½ä»¤æ’åºæ—¶ï¼Œå°å†™å­—æ¯ä¼šå…ˆå‡ºç°ã€‚
> 
> æ¯”è¾ƒæµ‹è¯•ä¸­ä½¿ç”¨çš„æ˜¯æ ‡å‡†çš„ASCIIé¡ºåºï¼Œæ ¹æ®æ¯ä¸ªå­—ç¬¦çš„ASCIIæ•°å€¼æ¥å†³å®šæ’åºç»“æœã€‚sort å‘½ä»¤ä½¿ç”¨çš„æ˜¯ç³»ç»Ÿçš„æœ¬åœ°åŒ–è¯­è¨€è®¾ç½®ä¸­å®šä¹‰çš„æ’åºé¡ºåºã€‚å¯¹äºè‹±è¯­ï¼Œæœ¬åœ°åŒ–è®¾ç½®æŒ‡å®šäº†åœ¨æ’åºé¡ºåºä¸­å°å†™å­—æ¯å‡ºç°åœ¨å¤§å†™å­—æ¯å‰ã€‚

> ğŸ’¡
> ç©ºçš„å’Œæœªåˆå§‹åŒ–çš„å˜é‡ä¼šå¯¹shellè„šæœ¬æµ‹è¯•é€ æˆç¾éš¾æ€§çš„å½±å“ã€‚å¦‚æœä¸æ˜¯å¾ˆç¡®å®šä¸€ä¸ªå˜é‡çš„å†…å®¹ï¼Œæœ€å¥½åœ¨å°†å…¶ç”¨äºæ•°å€¼æˆ–å­—ç¬¦ä¸²æ¯”è¾ƒä¹‹å‰å…ˆé€šè¿‡-n æˆ–-z æ¥æµ‹è¯•ä¸€ä¸‹å˜é‡æ˜¯å¦å«æœ‰å€¼ã€‚

### æ–‡ä»¶æ¯”è¾ƒ

| æµ‹è¯•æ–‡ä»¶è¡¨è¾¾å¼ |	å¦‚æœä¸ºçœŸ |
| ------------ | ------ |
| file1 -ef file2	| file1 å’Œ file2 æ‹¥æœ‰ç›¸åŒçš„ç´¢å¼•å·ï¼ˆé€šè¿‡ç¡¬é“¾æ¥ä¸¤ä¸ªæ–‡ä»¶åæŒ‡å‘ç›¸åŒçš„æ–‡ä»¶ï¼‰ã€‚| 
| file1 -nt file2	| file1 æ–°äº file2ã€‚|
| file1 -ot file2	| file1 æ—©äº file2ã€‚|
| -b file	| file å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå—ï¼ˆè®¾å¤‡ï¼‰æ–‡ä»¶ã€‚|
| -c file	| file å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼ˆè®¾å¤‡ï¼‰æ–‡ä»¶ã€‚|
| -d file	| file å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªç›®å½•ã€‚|
| -e file	| file å­˜åœ¨ã€‚|
| -f file	| file å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ã€‚|
| -g file	| file å­˜åœ¨å¹¶ä¸”è®¾ç½®äº†ç»„ IDã€‚|
| -G file	| file å­˜åœ¨å¹¶ä¸”ç”±æœ‰æ•ˆç»„ ID æ‹¥æœ‰ã€‚|
| -k file	| file å­˜åœ¨å¹¶ä¸”è®¾ç½®äº†å®ƒçš„ â€œsticky bitâ€ã€‚|
| -L file	| file å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥ã€‚|
| -O file	| file å­˜åœ¨å¹¶ä¸”ç”±æœ‰æ•ˆç”¨æˆ· ID æ‹¥æœ‰ã€‚|
| -p file	| file å­˜åœ¨å¹¶ä¸”æ˜¯ä¸€ä¸ªå‘½åç®¡é“ã€‚|
| -r file	| file å­˜åœ¨å¹¶ä¸”å¯è¯»ï¼ˆæœ‰æ•ˆç”¨æˆ·æœ‰å¯è¯»æƒé™ï¼‰ã€‚|
| -s file	| file å­˜åœ¨ä¸”å…¶é•¿åº¦å¤§äºé›¶ã€‚|
| -S file	| file å­˜åœ¨ä¸”æ˜¯ä¸€ä¸ªç½‘ç»œ socketã€‚|
| -t fd	| fd æ˜¯ä¸€ä¸ªå®šå‘åˆ°ç»ˆç«¯ï¼ä»ç»ˆç«¯å®šå‘çš„æ–‡ä»¶æè¿°ç¬¦ ã€‚ è¿™å¯ä»¥è¢«ç”¨æ¥å†³å®šæ˜¯å¦é‡å®šå‘äº†æ ‡å‡†è¾“å…¥ï¼è¾“å‡ºé”™è¯¯ã€‚|
| -u file	| file å­˜åœ¨å¹¶ä¸”è®¾ç½®äº† setuid ä½ã€‚|
| -w file	| file å­˜åœ¨å¹¶ä¸”å¯å†™ï¼ˆæœ‰æ•ˆç”¨æˆ·æ‹¥æœ‰å¯å†™æƒé™ï¼‰ã€‚|
| -x file	| file å­˜åœ¨å¹¶ä¸”å¯æ‰§è¡Œï¼ˆæœ‰æ•ˆç”¨æˆ·æœ‰æ‰§è¡Œï¼æœç´¢æƒé™ï¼‰ã€‚|

ç¤ºä¾‹ä»£ç ï¼š
```bash
#!/bin/bash
# test-file: Evaluate the status of a file
FILE=~/.bashrc
if [ -e "$FILE" ]; then
    if [ -f "$FILE" ]; then
        echo "$FILE is a regular file."
    fi
    if [ -d "$FILE" ]; then
        echo "$FILE is a directory."
    fi
    if [ -r "$FILE" ]; then
        echo "$FILE is readable."
    fi
    if [ -w "$FILE" ]; then
        echo "$FILE is writable."
    fi
    if [ -x "$FILE" ]; then
        echo "$FILE is executable/searchable."
    fi
else
    echo "$FILE does not exist"
    exit 1
fi
exit
```
æ³¨æ„ï¼š
1. åœ¨è¡¨è¾¾å¼ä¸­å‚æ•° $FILE æ˜¯æ€æ ·è¢«å¼•ç”¨çš„ã€‚å¼•å·å¹¶ä¸æ˜¯å¿…éœ€çš„ï¼Œä½†è¿™æ˜¯ä¸ºäº†é˜²èŒƒç©ºå‚æ•°ã€‚å¦‚æœ $FILE çš„å‚æ•°å±•å¼€ æ˜¯ä¸€ä¸ªç©ºå€¼ï¼Œå°±ä¼šå¯¼è‡´ä¸€ä¸ªé”™è¯¯ï¼ˆæ“ä½œç¬¦å°†ä¼šè¢«è§£é‡Šä¸ºéç©ºçš„å­—ç¬¦ä¸²è€Œä¸æ˜¯æ“ä½œç¬¦ï¼‰ã€‚
2. æ³¨æ„è„šæœ¬æœ«å°¾çš„ exit å‘½ä»¤ã€‚ è¿™ä¸ª exit å‘½ä»¤æ¥å—ä¸€ä¸ªå•ç‹¬çš„ï¼Œå¯é€‰çš„å‚æ•°ï¼Œå…¶æˆä¸ºè„šæœ¬çš„é€€å‡ºçŠ¶æ€ã€‚

```bash
test_file () {
    # test-file: Evaluate the status of a file
    FILE=~/.bashrc
    if [ -e "$FILE" ]; then
        if [ -f "$FILE" ]; then
            echo "$FILE is a regular file."
        fi
        if [ -d "$FILE" ]; then
            echo "$FILE is a directory."
        fi
        if [ -r "$FILE" ]; then
            echo "$FILE is readable."
        fi
        if [ -w "$FILE" ]; then
            echo "$FILE is writable."
        fi
        if [ -x "$FILE" ]; then
            echo "$FILE is executable/searchable."
        fi
    else
        echo "$FILE does not exist"
        # åœ¨å‡½æ•°ä¸­ï¼Œç”¨ return è¯­å¥æ¥ä»£æ›¿ exit å‘½ä»¤ï¼Œ ä»¥å¾—åˆ°æœŸæœ›çš„è¡Œä¸ºã€‚
        return 1
    fi
}
```

### å¤åˆæ¡ä»¶æµ‹è¯•

if-then è¯­å¥å…è®¸ä½ ä½¿ç”¨å¸ƒå°”é€»è¾‘æ¥ç»„åˆæµ‹è¯•ã€‚æœ‰ä¸¤ç§å¸ƒå°”è¿ç®—ç¬¦å¯ç”¨ï¼š

1. AND å¸ƒå°”è¿ç®—ç¬¦ï¼Œä¸¤ä¸ªæ¡ä»¶éƒ½å¿…é¡»æ»¡è¶³ï¼Œè¿”å› True
    `[ condition1 ] && [ condition2 ]`

2. OR å¸ƒå°”è¿ç®—ç¬¦ï¼Œä¸¤ä¸ªæ¡ä»¶å…¶ä¸­ä»»æ„ä¸€ä¸ªæ»¡è¶³ï¼Œè¿”å› True
   `[ condition1 ] || [ condition2 ]`

ç¤ºä¾‹è„šæœ¬ï¼š
```shell
#!/bin/bash
# testing compound comparisons

if [ -d $HOME ] && [ -w $HOME/testing ]; then
	echo "The file exists and you can write to it"
else
	echo "I cannot write to it"
fi
```

|é€»è¾‘æ“ä½œç¬¦	|æµ‹è¯•	|[[ ]] and (( ))|
|----------|----|---------------|
|AND|	-a|	&&|
|OR|	-o|	\|\| | 
|NOT	|!|	!|

### (()) - æ”¯æŒé«˜çº§æ•°å­¦è¡¨è¾¾å¼

åŒæ‹¬å·`(( expression ))`å‘½ä»¤å…è®¸ä½ åœ¨æ¯”è¾ƒè¿‡ç¨‹ä¸­ä½¿ç”¨é«˜çº§æ•°å­¦è¡¨è¾¾å¼ã€‚å¦‚ï¼Œè‡ªå¢ã€è‡ªå‡ã€é€»è¾‘è¿ç®—ã€ä½ç§»è¿ç®—ç­‰ã€‚

ç¤ºä¾‹è„šæœ¬ï¼š
```shell
#!/bin/bash
# using double parenthesis

var1=10

# ** è¡¨ç¤ºå¹‚è¿ç®—
# æ³¨æ„ï¼šä¸éœ€è¦å°†åŒæ‹¬å·ä¸­è¡¨è¾¾å¼é‡Œçš„å¤§äºå·è½¬ä¹‰ã€‚è¿™æ˜¯åŒæ‹¬å·å‘½ä»¤æä¾›çš„å¦ä¸€ä¸ªé«˜çº§ç‰¹æ€§ã€‚
if (($var1 ** 2 > 90)); then
	((var2 = $var1 ** 2))
	echo "The square of $var1 is $var2"
fi
```

### [[]] - æ”¯æŒé«˜çº§å­—ç¬¦ä¸²å¤„ç†åŠŸèƒ½

è¯­æ³•ï¼š
```bash
[[ expression ]]
```

è¿™ä¸ª `[[ ]]` å‘½ä»¤éå¸¸ç›¸ä¼¼äº `test` å‘½ä»¤ï¼ˆå®ƒæ”¯æŒæ‰€æœ‰çš„è¡¨è¾¾å¼ï¼‰ï¼Œä½†æ˜¯å¢åŠ äº†ä¸€ä¸ªé‡è¦çš„æ–°çš„å­—ç¬¦ä¸²è¡¨è¾¾å¼ï¼š
```bash
string1 =~ regex
```
å¦‚æœ string1 åŒ¹é…æ‰©å±•çš„æ­£åˆ™è¡¨è¾¾å¼ regexï¼Œå…¶è¿”å›å€¼ä¸ºçœŸã€‚
`[[ ]]` æ·»åŠ çš„å¦ä¸€ä¸ªåŠŸèƒ½æ˜¯`==`æ“ä½œç¬¦æ”¯æŒç±»å‹åŒ¹é…ï¼Œæ­£å¦‚è·¯å¾„åå±•å¼€æ‰€åšçš„é‚£æ ·ã€‚

```shell
#!/bin/bash
# using pattern matching

if [[ $USER == r* ]]; then
	echo "Hello $USER"
else
	echo "Sorry, I do not know you"
fi
```


### æ§åˆ¶æ“ä½œç¬¦ - åˆ†æ”¯çš„å¦ä¸€ç§æ–¹æ³•

bash æ”¯æŒä¸¤ç§å¯ä»¥æ‰§è¡Œåˆ†æ”¯ä»»åŠ¡çš„æ§åˆ¶æ“ä½œç¬¦ã€‚è¿™ä¸ª `&&ï¼ˆANDï¼‰`å’Œ `||ï¼ˆORï¼‰`æ“ä½œç¬¦ä½œç”¨å¦‚åŒå¤åˆå‘½ä»¤ `[[ ]]` ä¸­çš„é€»è¾‘æ“ä½œç¬¦ã€‚è¿™æ˜¯è¯­æ³•ï¼š

```bash
# å…ˆæ‰§è¡Œ command1ï¼Œå¹¶ä¸”åªæœ‰ command1 æ‰§è¡ŒæˆåŠŸåï¼Œæ‰ä¼šæ‰§è¡Œ command2ã€‚
command1 && command2
```
å’Œ
```bash
# å…ˆæ‰§è¡Œ command1ï¼Œå¹¶ä¸”åªæœ‰ command1 æ‰§è¡Œå¤±è´¥åï¼Œ æ‰ä¼šæ‰§è¡Œ command2
command1 || command2
```

ç¤ºä¾‹ä»£ç ï¼š
```bash
mkdir temp && cd temp
```

## case åˆ†æ”¯

Bash çš„å¤šé€‰å¤åˆå‘½ä»¤ç§°ä¸º caseã€‚å®ƒçš„è¯­æ³•è§„åˆ™å¦‚ä¸‹æ‰€ç¤ºï¼š
```bash
case variable in
pattern1 | pattern2) commands1;;
pattern3) commands2;;
*) default commands;;
esac
```

ç¤ºä¾‹ä»£ç ï¼š
```bash
#!/bin/bash
# case-menu: a menu driven system information program
clear
echo "
Please Select:
1. Display System Information
2. Display Disk Space
3. Display Home Space Utilization
0. Quit
"
read -p "Enter selection [0-3] > "
case $REPLY in
    0)  echo "Program terminated."
        exit
        ;;
    1)  echo "Hostname: $HOSTNAME"
        uptime
        ;;
    2)  df -h
        ;;
    3)  if [[ $(id -u) -eq 0 ]]; then
            echo "Home Space Utilization (All Users)"
            du -sh /home/*
        else
            echo "Home Space Utilization ($USER)"
            du -sh $HOME
        fi
        ;;
    *)  echo "Invalid entry" >&2
        exit 1
        ;;
esac
```

|case æ¨¡å¼	|æè¿°|
|------------|---|
|a)	|è‹¥å•è¯ä¸º â€œaâ€ï¼Œåˆ™åŒ¹é…|
|[[:alpha:]])	|è‹¥å•è¯æ˜¯ä¸€ä¸ªå­—æ¯å­—ç¬¦ï¼Œåˆ™åŒ¹é…|
|???)	|è‹¥å•è¯åªæœ‰ 3 ä¸ªå­—ç¬¦ï¼Œåˆ™åŒ¹é…|
|.txt)|	è‹¥å•è¯ä»¥ â€œ.txtâ€ å­—ç¬¦ç»“å°¾ï¼Œåˆ™åŒ¹é…|
|)|	åŒ¹é…ä»»æ„å•è¯ã€‚æŠŠè¿™ä¸ªæ¨¡å¼åšä¸º case å‘½ä»¤çš„æœ€åä¸€ä¸ªæ¨¡å¼ï¼Œæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„åšæ³•ï¼Œ å¯ä»¥æ•æ‰åˆ°ä»»æ„ä¸€ä¸ªä¸å…ˆå‰æ¨¡å¼ä¸åŒ¹é…çš„æ•°å€¼ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•æ‰åˆ°ä»»ä½•å¯èƒ½çš„æ— æ•ˆå€¼ã€‚|

### ä½ç½®å‚æ•°

å¯ä»¥ç”¨ä½ç½®å‚æ•°æ¥è®¿é—®å‘½ä»¤è¡Œä¸­çš„å†…å®¹ã€‚


```bash
[me@linuxbox ~]$ posit-param a b c d
$0 = /home/me/bin/posit-param # å³ä½¿ä¸å¸¦å‘½ä»¤è¡Œå‚æ•°ï¼Œä½ç½®å‚æ•° $0 æ€»ä¼šåŒ…å«å‘½ä»¤è¡Œä¸­å‡ºç°çš„ç¬¬ä¸€ä¸ªå•è¯ï¼Œä¹Ÿå°±æ˜¯å·²æ‰§è¡Œç¨‹åºçš„è·¯å¾„åã€‚
$1 = a # ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ a
$2 = b
$3 = c
$4 = d
$5 =
$6 =
$7 =
$8 =
$9 =
```

* æ³¨æ„ï¼š å®é™…ä¸Šé€šè¿‡å‚æ•°å±•å¼€æ–¹å¼ä½ å¯ä»¥è®¿é—®çš„å‚æ•°ä¸ªæ•°å¤šäº 9 ä¸ªã€‚åªè¦æŒ‡å®šä¸€ä¸ªå¤§äº 9 çš„æ•°å­—ï¼Œç”¨èŠ±æ‹¬å·æŠŠè¯¥æ•°å­—æ‹¬èµ·æ¥å°±å¯ä»¥ã€‚ ä¾‹å¦‚ ${10}ï¼Œ ${55}ï¼Œ ${211}ï¼Œ

#### ç¡®å®šå‚æ•°ä¸ªæ•°
shell è¿˜æä¾›äº†ä¸€ä¸ªåä¸º $#ï¼Œå¯ä»¥å¾—åˆ°å‘½ä»¤è¡Œå‚æ•°ä¸ªæ•°çš„å˜é‡ã€‚

#### shift - è®¿é—®å¤šä¸ªå‚æ•°çš„åˆ©å™¨




## for å¾ªç¯

è¯­æ³•ä¸€ï¼š
```bash
for variable in list; do
    commands
done
```
è¯­æ³•äºŒï¼šæœ€æ–°ç‰ˆæœ¬çš„ bash å·²ç»æ·»åŠ äº†ç¬¬äºŒç§æ ¼å¼çš„ for å‘½ä»¤è¯­æ³•ï¼Œè¯¥è¯­æ³•ç›¸ä¼¼äº C è¯­è¨€ä¸­çš„ for è¯­æ³•æ ¼å¼ï¼š
```bash
for (( expression1; expression2; expression3 )); do
    commands
done
```

ç¤ºä¾‹ä»£ç 1ï¼š
```bash
report_home_space () {
    local format="%8s%10s%10s\n"
    local i dir_list total_files total_dirs total_size user_name
    if [[ $(id -u) -eq 0 ]]; then
        dir_list=/home/*
        user_name="All Users"
    else
        dir_list=$HOME
        user_name=$USER
    fi
    echo "<H2>Home Space Utilization ($user_name)</H2>"
    for i in $dir_list; do
        total_files=$(find $i -type f | wc -l)
        total_dirs=$(find $i -type d | wc -l)
        total_size=$(du -sh $i | cut -f 1)
        echo "<H3>$i</H3>"
        echo "<PRE>"
        printf "$format" "Dirs" "Files" "Size"
        printf "$format" "----" "-----" "----"
        printf "$format" $total_dirs $total_files $total_size
        echo "</PRE>"
    done
    return
}
```

ç¤ºä¾‹ä»£ç 2:

```shell
#!/bin/bash

# è¯»å–åˆ—è¡¨ä¸­çš„å€¼
for test in Alabama Alaska Arizona; do
	echo The next state is $test
done

# è§£å†³ â€œshellçœ‹åˆ°äº†åˆ—è¡¨å€¼ä¸­çš„å•å¼•å·å¹¶å°è¯•ä½¿ç”¨å®ƒä»¬æ¥å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„æ•°æ®å€¼â€é—®é¢˜
# 1. ä½¿ç”¨è½¬ä¹‰å­—ç¬¦ï¼ˆåæ–œæ ï¼‰æ¥å°†å•å¼•å·è½¬ä¹‰ã€‚
# 2. ä½¿ç”¨åŒå¼•å·æ¥å®šä¹‰ç”¨åˆ°å•å¼•å·çš„å€¼ã€‚
for test in I don\'t know if "this'll" work; do
	echo "word:$test"
done

# for å¾ªç¯å‡å®šæ¯ä¸ªå€¼éƒ½æ˜¯ç”¨ç©ºæ ¼åˆ†å‰²çš„ï¼Œå› æ­¤è¿™é‡Œè¦ç”¨åŒå¼•å·åœˆèµ·æ•°æ®å€¼ä¸­æœ‰ç©ºæ ¼çš„å€¼ã€‚
for test in Nevada "New Hampshire" "New Mexico" "New York"; do
    echo "Now going to $test"
done
```

### ä»å˜é‡è¯»å–åˆ—è¡¨
```shell
#!/bin/bash

list="Alabama Alaska Arizona"
# å‘ list åˆ—è¡¨ä¸­è¿½åŠ å€¼
list=$list" Connecticut"

for state in $list; do
	echo "Have you ever visited $state"
done
```

### æ›´æ”¹å­—æ®µåˆ†éš”ç¬¦

IFS ç¯å¢ƒå˜é‡å®šä¹‰äº† bash shell ç”¨ä½œå­—æ®µåˆ†éš”ç¬¦çš„ä¸€ç³»åˆ—å­—ç¬¦ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œbash shell ä¼šå°†ä¸‹åˆ—å­—ç¬¦å½“ä½œå­—æ®µåˆ†éš”ç¬¦ï¼š
* ç©ºæ ¼
* åˆ¶è¡¨ç¬¦
* æ¢è¡Œç¬¦

```shell
#!/bin/bash
# reading values from a file

file="states"

# ä¸´æ—¶æ›´æ”¹ IFS ç¯å¢ƒå˜é‡
IFS=$'\n'
# ä»å‘½ä»¤è¯»å–å€¼
for state in $(cat $file); do
    echo "Visit beautiful $state"
done

# ä½ ä¹Ÿå¯ä»¥åœ¨ä¹‹åæ¢å¤é»˜è®¤å€¼
IFS=$IFS.OLD
```

éå†ä¸€ä¸ªæ–‡ä»¶ä¸­ç”¨å†’å·åˆ†éš”çš„å€¼ï¼š`IFS=:`
æŒ‡å®šå¤šä¸ª IFS å­—ç¬¦ï¼š`IFS=$'\n':;"`

### ç”¨é€šé…ç¬¦è¯»å–ç›®å½•

ç”¨ for å‘½ä»¤æ¥è‡ªåŠ¨éå†ç›®å½•ä¸­çš„æ–‡ä»¶æ—¶ï¼Œå¿…é¡»åœ¨æ–‡ä»¶åæˆ–è·¯å¾„åä¸­ä½¿ç”¨é€šé…ç¬¦ã€‚å®ƒä¼šå¼ºåˆ¶shellä½¿ç”¨ **æ–‡ä»¶æ‰©å±•åŒ¹é…**ã€‚

```shell
#!/bin/bash
# iterate through all the files in a directory

for file in /home/tiandi/test/*; do
	if [ -d "$file" ]; then
		echo "$file is a directory"
	elif [ -f "$file" ]; then
		echo "$file is a file"
	fi
done
```

## while å¾ªç¯


while å‘½ä»¤çš„è¯­æ³•æ˜¯ï¼š
```bash
while commands; do commands; done
```
å’Œ if ä¸€æ ·ï¼Œ while è®¡ç®—ä¸€ç³»åˆ—å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ã€‚åªè¦é€€å‡ºçŠ¶æ€ä¸ºé›¶ï¼Œå®ƒå°±æ‰§è¡Œå¾ªç¯å†…çš„å‘½ä»¤ã€‚
ç¤ºä¾‹ä»£ç ï¼š
```bash
#!/bin/bash
# while-count: display a series of numbers

count=1
while [ $count -le 5 ]; do
    echo $count
    count=$((count + 1))
done
echo "Finished."
```

## util å¾ªç¯

until å‘½ä»¤å’Œ while å‘½ä»¤å·¥ä½œçš„æ–¹å¼å®Œå…¨ç›¸åã€‚until å‘½ä»¤è¦æ±‚ä½ æŒ‡å®šä¸€ä¸ªé€šå¸¸è¿”å›éé›¶é€€å‡ºçŠ¶æ€ç çš„æµ‹è¯•å‘½ä»¤ã€‚**åªæœ‰æµ‹è¯•å‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç ä¸ä¸º0ï¼Œbash shell æ‰ä¼šæ‰§è¡Œå¾ªç¯ä¸­åˆ—å‡ºçš„å‘½ä»¤**ã€‚ä¸€æ—¦æµ‹è¯•å‘½ä»¤è¿”å›äº†é€€å‡ºçŠ¶æ€ç 0ï¼Œå¾ªç¯å°±ç»“æŸäº†ã€‚

æ ¼å¼è¯­æ³•ï¼š
```shell
until test commands
do
    other commands
done
```

ç¤ºä¾‹ä»£ç ï¼š
```shell
#!/bin/bash
# using the until command

# åªè¦è¯¥å˜é‡çš„å€¼ç­‰äº0ï¼Œuntil å‘½ä»¤å°±ä¼šåœæ­¢å¾ªç¯
var1=100
until [ $var1 -eq 0 ]; do
	echo $var1
	var1=$(($var1 - 25))
done

# ä½¿ç”¨å¤šä¸ªæµ‹è¯•å‘½ä»¤æ—¶ï¼Œåªæœ‰æœ€åä¸€ä¸ªå‘½ä»¤çš„é€€å‡ºçŠ¶æ€ç å†³å®šäº† bash shell æ˜¯å¦æ‰§è¡Œå·²å®šä¹‰çš„ other commands
var1=100
until
	echo $var1
	[ $var1 -eq 0 ]
do
	echo Inside the loop: $var1
	var1=$(($var1 - 25))
done
```

## è·³å‡ºå¾ªç¯
bash æä¾›äº†ä¸¤ä¸ªå†…éƒ¨å‘½ä»¤ï¼Œå®ƒä»¬å¯ä»¥ç”¨æ¥åœ¨å¾ªç¯å†…éƒ¨æ§åˆ¶ç¨‹åºæµç¨‹ã€‚
* `break` å‘½ä»¤ç«‹å³ç»ˆæ­¢ä¸€ä¸ªå¾ªç¯ï¼Œ ä¸”ç¨‹åºç»§ç»­æ‰§è¡Œå¾ªç¯ä¹‹åçš„è¯­å¥ã€‚
* `continue` å‘½ä»¤å¯¼è‡´ç¨‹åºè·³è¿‡å¾ªç¯ä¸­å‰©ä½™çš„è¯­å¥ï¼Œä¸”ç¨‹åºç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ã€‚

### break å‘½ä»¤

ç¤ºä¾‹è„šæœ¬1ï¼Œè·³å‡ºå•ä¸ªå¾ªç¯ï¼š
```shell
#!/bin/bash

# è·³å‡ºå•ä¸ªå¾ªç¯
for var1 in 1 2 3 4 5 6 7 8 9 10; do
	if [ $var1 -eq 5 ]; then
		break
	fi
	echo "Iteration number: $var1"
done
echo "The for loop is completed"

# è·³å‡º while å¾ªç¯
var1=1
while [ $var1 -lt 10 ]; do
  if [ $var1 -eq 5 ]; then
    break
  fi
  echo "Iteration number: $var1"
  var1=$[ $var1 + 1 ]
done
echo "The for loop is completed"

# è·³å‡ºå†…éƒ¨å¾ªç¯
for ((a = 1; a < 4; a++)); do
	echo "Outer loop : $a"
	for ((b = 1; b < 100; b++)); do
		if [ $b -gt 4 ]; then
			break
		fi
		echo " Inner loop:$b"
	done
done
```

ç¤ºä¾‹è„šæœ¬2ï¼Œè·³å‡ºæŒ‡å®šå¾ªç¯ï¼š
è¯­æ³•ï¼š`break n`

```shell
#!/bin/bash

# break n æŒ‡å®šè¦è·³å‡ºçš„å¾ªç¯å±‚çº§
# é»˜è®¤æƒ…å†µä¸‹ï¼Œn ä¸º 1ï¼Œè¡¨æ˜è·³å‡ºçš„æ˜¯å½“å‰çš„å¾ªç¯ã€‚
# å¦‚æœä½ å°† n è®¾ä¸º 2ï¼Œbreak å‘½ä»¤å°±ä¼šåœæ­¢ä¸‹ä¸€çº§çš„å¤–éƒ¨å¾ªç¯ã€‚

for ((a = 1; a < 4; a++)); do
	echo "Outer loop : $a"
	for ((b = 1; b < 100; b++)); do
		if [ $b -gt 4 ]; then
			break 2
		fi
		echo " Inner loop:$b"
	done
done
```

### continue å‘½ä»¤

ç¤ºä¾‹è„šæœ¬1ï¼š
```shell
#!/bin/bash
# using the continue command

for ((var1 = 1; var1 < 15; var1++)); do
	if [ $var1 -gt 5 ] && [ $var1 -lt 10 ]; then
		continue
	fi
	echo "Iteration number:$var1"
done
```

ç¤ºä¾‹è„šæœ¬2ï¼Œé€€å‡ºæŒ‡å®šå¾ªç¯ï¼š
```shell
#!/bin/bash
# continuing an outer loop

for ((a = 1; a <= 5; a++)); do
	echo "Iteration $a:"
	for ((b = 1; b < 3; b++)); do
		if [ $a -gt 2 ] && [ $a -lt 4 ]; then
		  # continue nï¼ŒæŒ‡å®šè¦é€€å‡ºçš„å¾ªç¯å±‚çº§
			# ç”¨continue å‘½ä»¤æ¥åœæ­¢å¤„ç†å¾ªç¯å†…çš„å‘½ä»¤ï¼Œä½†ä¼šç»§ç»­å¤„ç†å¤–éƒ¨å¾ªç¯ã€‚
			continue 2
		fi
		var3=$(($a * $b))
		echo " The result of $a * $b is $var3"
	done
done
```