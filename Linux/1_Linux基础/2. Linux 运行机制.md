[TOC]

## Linux 系统的启动过程

Linux操作系统将运行中的程序称为进程。进程可以在前台运行，将输出显示在屏幕上，也可以在后台运行，隐藏到幕后。内核控制着Linux系统如何管理运行在系统上的所有进程。

内核创建了第一个进程（称为init进程 ）来启动系统上所有其他进程。当内核启动时，它会将init进程加载到虚拟内存中。内核在启动任何其他进程时，都会在虚拟内存中给新进程分配一块专有区域来存储该进程用到的数据和代码。

一些Linux发行版使用一个表来管理在系统开机时要自动启动的进程。在Linux系统上，这个表通常位于专门文件/etc/inittab中。

另外一些系统（比如现在流行的Ubuntu Linux发行版）则采用/etc/init.d目录，将开机时启动或停止某个应用的脚本放在这个目录下。这些脚本通过/etc/rcX.d目录下的入口（entry）1 启动，这里的X代表运行级 （run level）。

运行级为1时，只启动基本的系统进程以及一个控制台终端进程。我们称之为单用户模式。单用户模式通常用来在系统有问题时进行紧急的文件系统维护。显然，在这种模式下，仅有一个人（通常是系统管理员）能登录到系统上操作数据。

标准的启动运行级是3。在这个运行级上，大多数应用软件，比如网络支持程序，都会启动。

另一个Linux中常见的运行级是5。在这个运行级上系统会启动图形化的X Window系统，允许用户通过图形化桌面窗口登录系统。

Linux系统可以通过调整启动运行级来控制整个系统的功能。通过将运行级从3调整成5，系统就可以从基于控制台的系统变成更先进的图形化X Window系统。


![image](https://ws3.sinaimg.cn/large/006tNc79ly1fz0f1yfy62j30o202gt8t.jpg)


* 内核引导：基本输入输出系统 BIOS —> 主引导记录MBR —> 引导加载器 Grub/LILO。
* init 的配置文件是：**/etc/inittab**


### 服务器启动脚本

一些Linux发行版使用一个表来管理在系统开机时要自动启动的进程。在Linux系统上，这个表通常位于专门文件 /etc/inittab 中。

另外一些系统（比如现在流行的Ubuntu Linux发行版）则采用 /etc/init.d 目录，将开机时启动或停止某个应用的脚本放在这个目录下。

* 启动服务器应用程序的脚本位于 **/etc/init.d** 目录下，每个脚本各控制着一个特定的守护进程。
* Ubuntu 和 Debain 使用 **upstart** (非 init) 管理启动脚本。Ubuntu 和 Debain 默认没有 inittab 文件，而是使用 **/etc/event.d/rc-default** 来确定启动的默认运行级。


#### `start`、`stop` 启动、停止服务器守护进程

```shell
$ sudo /etc/init.d/sshd start    ## 启动 SSH 服务器守护进程
$ sudo /etc/init.d/sshd stop     ## 停止 SSH 服务器守护进程
$ sudo /etc/init.d/sshd restart  ## 重启 SSH 服务器守护进程
```

#### `inetd` 、 `xinetd` 切换服务器守护进程的运行方式

服务器守护进程的2种运行方式：

1. **standalone 模式**：随系统启动而启动，并持续在后台监听。
2. **inetd/xinetd 模式**：在需要的时候启动，完成任务后把监听任务交给 inetd/xinetd。



#### 配置 xinetd
xinetd 守护进程依赖于 **/etc/xinetd.conf** 的配置，用户应该为每个服务单独开辟一个文件，存放在 **/etc/xinetd.d**目录下。查看 xinetd. conf可以看到这一点。